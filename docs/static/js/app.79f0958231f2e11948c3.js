webpackJsonp([1],{"3MyM":function(t,e){},"7zck":function(t,e){},BgfR:function(t,e){},EGgQ:function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("7+uW"),r=a("Xxa5"),n=a.n(r),o=a("exGp"),i=a.n(o),l=a("olAn"),c=a("Zrlr"),u=a.n(c),d=a("wxAW"),h=a.n(d),v=a("yviF"),p=a.n(v),g=(a("881v"),new(function(){function t(){u()(this,t);p.a.apps.length||p.a.initializeApp({apiKey:"AIzaSyAGG7_qNlsnDTRePGGsB8Q3Cbit27AkDwQ",authDomain:"devzone-27674.firebaseapp.com",databaseURL:"https://devzone-27674.firebaseio.com",projectId:"devzone-27674",storageBucket:"",messagingSenderId:"1024656756798"}),this.db=p.a.firestore(),this.db.settings({timestampsInSnapshots:!0})}return h()(t,[{key:"isRegisteredEmail",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.db.collection("accounts").where("email","==",t).get().then(function(e){return e.docs.length>0&&t.length>0})}},{key:"login",value:function(t,e){var a=this.db.collection("accounts");return a.where("email","==",t).where("password","==",e).limit(1).get().then(function(t){var e=void 0;return t.forEach(function(t){(e={}).userId=t.id,e.userName=t.data().userName,a.doc(e.userId).set({login_time:new Date,logged_in:!0},{merge:!0})}),e}).catch(function(t){console.log(t)})}},{key:"logout",value:function(t){return this.db.collection("accounts").doc(t).set({logout_time:new Date,logged_in:!1},{merge:!0}).then(function(){return!0}).catch(function(t){return console.log("登出錯誤"),!1})}},{key:"register",value:function(t,e,a){return this.db.collection("accounts").add({email:t,userName:e,password:a,created_time:new Date,login_time:null,logout_time:null,logged_in:!1}).then(function(){return!0}).catch(function(t){return console.log("註冊錯誤"),!1})}},{key:"getFriendList",value:function(t){if(t)return this.db.collection("friends").doc(t).collection("friends").get().then(function(t){var e=[];return t.forEach(function(t){e.push(t.data())}),e}).catch(function(t){console.log(t)})}},{key:"getChat",value:function(t,e){if(t&&e)return this.db.collection("chats").doc(t).collection("chats").doc(e)}},{key:"sendMessage",value:function(t,e,a){var s=this.db.collection("chats").doc(t).collection("chats").doc(e),r=this.db.collection("chats").doc(e).collection("chats").doc(t);s.set({messages:a},{merge:!0}),r.set({messages:a},{merge:!0})}},{key:"searchUserByEmail",value:function(t){if(t)return this.db.collection("accounts").where("email","==",t).limit(1).get().then(function(t){var e=void 0;return t.forEach(function(t){e=t.data()}),e}).catch(function(t){console.log(t)})}},{key:"addFriend",value:function(t,e){var a=this;if(e)return this.db.collection("accounts").where("email","==",e).limit(1).get().then(function(e){e.forEach(function(e){var s=a.db.collection("friends").doc(t).collection("friends"),r=e.data();r.userId=e.id,s.add(r)})}).catch(function(t){console.log(t)})}},{key:"getTimeStamp",value:function(){var t=new Date,e=t.getMonth()+1,a=t.getDate(),s=t.getHours(),r=t.getMinutes();return e+"月"+a+"日 "+(s>=12?"下午":"上午")+" "+s+":"+(r<10?"0"+r:r)}},{key:"getCategoryList",value:function(){return this.db.collection("categories").get().then(function(t){var e=[];return t.forEach(function(t){e.push({url:t.id,text:t.data().name})}),e})}},{key:"getPostList",value:function(t,e){var a=this.db.collection("posts"),s="all"===t?a:a.where("category","==",t);switch(e){case"createdTime":s=s.orderBy("createdTime","desc");break;case"explore":s=s.orderBy("numOfExplore","desc");break;case"like":s=s.orderBy("numOfLike","desc");break;case"reply":s=s.orderBy("numOfReply","desc")}return s.get().then(function(t){var e=[];return t.forEach(function(t){var a=t.data();e.push({postId:t.id,title:a.title,authorName:a.authorName,createdTime:a.createdTime,like:a.numOfLike,reply:a.numOfReply,explore:a.numOfExplore})}),e})}},{key:"getPostData",value:function(t){return this.db.collection("posts").doc(t).get().then(function(t){return t.data()})}},{key:"addPost",value:function(t){return this.db.collection("posts").add({authorId:t.authorId,authorName:t.authorName,category:t.category,title:t.title,content:t.content,floor:0,numOfLike:0,numOfReply:0,numOfExplore:0,createdTime:new Date,isMarkdown:t.isMarkdown})}},{key:"increasePostExplore",value:function(t){var e=this.db.collection("posts");return this.getPostData(t).then(function(a){return e.doc(t).set({numOfExplore:a.numOfExplore+1},{merge:!0})})}},{key:"increasePostLike",value:function(t){var e=this.db.collection("posts");return this.getPostData(t).then(function(a){return e.doc(t).set({numOfLike:a.numOfLike+1},{merge:!0})})}},{key:"increasePostReply",value:function(t){var e=this.db.collection("posts");return this.getPostData(t).then(function(a){return e.doc(t).set({numOfReply:a.numOfReply+1},{merge:!0})})}}]),t}())),f={props:{show:Object,toggle:Boolean},components:{VueRecaptcha:l.a},watch:{toggle:function(t){this.reset()},inputEmail:function(t){this.show.bool&&this.checkEmail(t)},inputUsername:function(t){this.show.bool&&this.checkUsername(t)},inputPassword:function(t){this.show.bool&&this.checkPassword(t)}},data:function(){return{inputEmail:void 0,inputUsername:void 0,inputPassword:void 0,showProgress:!1,hide:!0,emailCheck:{hasChecked:!1,isError:!1,hint:""},usernameCheck:{hasChecked:!1,isError:!1,hint:""},passwordCheck:{hasChecked:!1,isError:!1,hint:""},hasPassedRecaptcha:!0}},methods:{reset:function(){var t=this;t.inputEmail=void 0,t.inputUsername=void 0,t.inputPassword=void 0,t.emailCheck.hasChecked=!1,t.emailCheck.isError=!1,t.emailCheck.hint="",t.usernameCheck.hasChecked=!1,t.usernameCheck.isError=!1,t.usernameCheck.hint="",t.passwordCheck.hasChecked=!1,t.passwordCheck.isError=!1,t.passwordCheck.hint=""},checkEmail:function(t){var e,a=this,s=this;if(s.emailCheck.hasChecked=!0,t){if(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t))(e=i()(n.a.mark(function t(e){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:g.isRegisteredEmail(e).then(function(t){t?(s.emailCheck.isError=!0,s.emailCheck.hint="已註冊過的信箱"):(s.emailCheck.isError=!1,s.emailCheck.hint="")});case 1:case"end":return t.stop()}},t,a)})),function(t){return e.apply(this,arguments)})(t);else s.emailCheck.isError=!0,s.emailCheck.hint="不正確的信箱格式"}else s.emailCheck.isError=!0,s.emailCheck.hint="必填欄位"},checkUsername:function(t){var e=this;e.usernameCheck.hasChecked=!0,t?t.length>=8?(e.usernameCheck.isError=!1,e.usernameCheck.hint=""):(e.usernameCheck.isError=!0,e.usernameCheck.hint="長度需大於等於 8"):(e.usernameCheck.isError=!0,e.usernameCheck.hint="必填欄位")},checkPassword:function(t){var e=this;e.passwordCheck.hasChecked=!0,t?t.length>=8?(e.passwordCheck.isError=!1,e.passwordCheck.hint=""):(e.passwordCheck.isError=!0,e.passwordCheck.hint="長度需大於等於 8"):(e.passwordCheck.isError=!0,e.passwordCheck.hint="必填欄位")},register:function(){var t=i()(n.a.mark(function t(){var e;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:(e=this).showProgress=!0,g.register(e.inputEmail,e.inputUsername,e.inputPassword).then(function(t){t&&(e.showProgress=!1,e.$emit("registered"),e.show.bool=!1)});case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),onCaptchaVerified:function(t){this.hasPassedRecaptcha=!0},onCaptchaExpired:function(){this.$refs.recaptcha.reset(),this.hasPassedRecaptcha=!0}}},m={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-dialog",{staticStyle:{position:"relative"},attrs:{"max-width":"400"},on:{click:function(e){return e.target!==e.currentTarget?null:t.reset(e)}},model:{value:t.show.bool,callback:function(e){t.$set(t.show,"bool",e)},expression:"show.bool"}},[a("v-card",[a("v-card-title",{staticClass:"text-center headline blue white--text"},[t._v("註冊")]),t._v(" "),a("v-card-text",[a("v-container",{attrs:{"grid-list-md":""}},[a("v-layout",{attrs:{wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{label:"信箱",autofocus:!0,error:t.emailCheck.isError,hint:t.emailCheck.hint,"persistent-hint":""},model:{value:t.inputEmail,callback:function(e){t.inputEmail=e},expression:"inputEmail"}})],1),t._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{label:"用戶名",error:t.usernameCheck.isError,hint:t.usernameCheck.hint,"persistent-hint":""},model:{value:t.inputUsername,callback:function(e){t.inputUsername=e},expression:"inputUsername"}})],1),t._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{"append-icon":t.hide?"visibility":"visibility_off","append-icon-cb":function(){return t.hide=!t.hide},type:t.hide?"password":"text",label:"密碼",error:t.passwordCheck.isError,hint:t.passwordCheck.hint,"persistent-hint":""},model:{value:t.inputPassword,callback:function(e){t.inputPassword=e},expression:"inputPassword"}})],1)],1)],1)],1),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{disabled:!t.emailCheck.hasChecked||t.emailCheck.isError||!t.usernameCheck.hasChecked||t.usernameCheck.isError||!t.passwordCheck.hasChecked||t.passwordCheck.isError,color:"green darken-1",flat:""},on:{click:t.register}},[t._v("註冊")])],1)],1),t._v(" "),a("v-progress-circular",{directives:[{name:"show",rawName:"v-show",value:t.showProgress,expression:"showProgress"}],staticStyle:{position:"absolute",top:"50%",right:"50%"},attrs:{indeterminate:"",color:"green"}})],1)},staticRenderFns:[]};var w=a("VU/8")(f,m,!1,function(t){a("3MyM")},null,null).exports,k={props:{show:Object,toggle:Boolean},components:{VueRecaptcha:l.a},watch:{toggle:function(t){this.reset()},inputEmail:function(t){this.show.bool&&this.checkEmail(t)},inputPassword:function(t){this.show.bool&&this.checkPassword(t)}},data:function(){return{inputEmail:void 0,inputPassword:void 0,showProgress:!1,hide:!0,emailCheck:{hasChecked:!1,isError:!1,hint:""},passwordCheck:{hasChecked:!1,isError:!1,hint:""},hasPassedRecaptcha:!0}},methods:{reset:function(){var t=this;t.inputEmail=void 0,t.inputPassword=void 0,t.emailCheck.hasChecked=!1,t.emailCheck.isError=!1,t.emailCheck.hint="",t.passwordCheck.hasChecked=!1,t.passwordCheck.isError=!1,t.passwordCheck.hint=""},checkEmail:function(t){var e,a=this,s=this;if(s.emailCheck.hasChecked=!0,t){if(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t))(e=i()(n.a.mark(function t(e){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:g.isRegisteredEmail(e).then(function(t){t?(s.emailCheck.isError=!1,s.emailCheck.hint=""):(s.emailCheck.isError=!0,s.emailCheck.hint="不存在的信箱")});case 1:case"end":return t.stop()}},t,a)})),function(t){return e.apply(this,arguments)})(t);else s.emailCheck.isError=!0,s.emailCheck.hint="不正確的信箱格式"}else s.emailCheck.isError=!0,s.emailCheck.hint="必填欄位"},checkPassword:function(t){var e=this;e.passwordCheck.hasChecked=!0,t?t.length>=8?(e.passwordCheck.isError=!1,e.passwordCheck.hint=""):(e.passwordCheck.isError=!0,e.passwordCheck.hint="長度需大於等於 8"):(e.passwordCheck.isError=!0,e.passwordCheck.hint="必填欄位")},login:function(){var t=i()(n.a.mark(function t(){var e;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:(e=this).showProgress=!0,g.login(e.inputEmail,e.inputPassword).then(function(t){e.showProgress=!1,t?(e.showProgress=!1,e.$emit("logged-in",t),e.show.bool=!1):(e.passwordCheck.isError=!0,e.passwordCheck.hint="密碼錯誤")});case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),onCaptchaVerified:function(t){this.hasPassedRecaptcha=!0},onCaptchaExpired:function(){this.$refs.recaptcha.reset(),this.hasPassedRecaptcha=!1}}},b={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-dialog",{staticStyle:{position:"relative"},attrs:{"max-width":"400"},model:{value:t.show.bool,callback:function(e){t.$set(t.show,"bool",e)},expression:"show.bool"}},[a("v-card",[a("v-card-title",{staticClass:"text-center headline blue white--text"},[t._v("登入")]),t._v(" "),a("v-card-text",[a("v-container",{attrs:{"grid-list-md":""}},[a("v-layout",{attrs:{wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{label:"信箱",error:t.emailCheck.isError,hint:t.emailCheck.hint,autofocus:!0,"persistent-hint":""},model:{value:t.inputEmail,callback:function(e){t.inputEmail=e},expression:"inputEmail"}})],1),t._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{label:"密碼","append-icon":t.hide?"visibility":"visibility_off","append-icon-cb":function(){return t.hide=!t.hide},type:t.hide?"password":"text",error:t.passwordCheck.isError,hint:t.passwordCheck.hint,"persistent-hint":""},model:{value:t.inputPassword,callback:function(e){t.inputPassword=e},expression:"inputPassword"}})],1)],1)],1)],1),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{disabled:!t.hasPassedRecaptcha||!t.emailCheck.hasChecked||t.emailCheck.isError||!t.passwordCheck.hasChecked||t.passwordCheck.isError,color:"green darken-1",flat:""},on:{click:t.login}},[t._v("登入")])],1)],1),t._v(" "),a("v-progress-circular",{directives:[{name:"show",rawName:"v-show",value:t.showProgress,expression:"showProgress"}],staticStyle:{position:"absolute",top:"50%",right:"50%"},attrs:{indeterminate:"",color:"green"}})],1)},staticRenderFns:[]};var _=a("VU/8")(k,b,!1,function(t){a("XdeR")},null,null).exports,x={props:{show:Object},data:function(){return{showProgress:!1}},methods:{logout:function(){var t=i()(n.a.mark(function t(){var e;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:(e=this).showProgress=!0,g.logout(e.globalObject.userData.userId).then(function(t){t&&(e.show.bool=!1,e.$emit("logged-out"),e.showProgress=!1)});case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}},C={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-dialog",{staticStyle:{position:"relative"},attrs:{"max-width":"290"},model:{value:t.show.bool,callback:function(e){t.$set(t.show,"bool",e)},expression:"show.bool"}},[a("v-card",[a("v-card-title",{staticClass:"headline blue white--text"},[t._v("登出確認")]),t._v(" "),a("v-card-text",[t._v("你確定要登出嗎？")]),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"green darken-1",flat:"flat"},nativeOn:{click:function(e){t.show.bool=!1}}},[t._v("返回")]),t._v(" "),a("v-btn",{attrs:{color:"green darken-1",flat:"flat"},on:{click:t.logout}},[t._v("確定")])],1)],1),t._v(" "),a("v-progress-circular",{directives:[{name:"show",rawName:"v-show",value:t.showProgress,expression:"showProgress"}],staticStyle:{position:"absolute",top:"50%",right:"50%"},attrs:{indeterminate:"",color:"green"}})],1)},staticRenderFns:[]},y={computed:{isLoggedIn:function(){return(this.globalObject.userData.userId||!1)===this.globalObject.userData.userId}},methods:{onLoggedIn:function(t){this.saveUserData(t)},onLoggedOut:function(){this.clearUserData()},onLoginLogoutClicked:function(){this.isLoggedIn?this.showLogoutDialog.bool=!0:this.showLoginDialog.bool=!0},onRegisterClicked:function(){this.showRegisterDialog.bool=!0}},data:function(){return{title:"DevZone",showLoginDialog:{bool:!1},showLogoutDialog:{bool:!1},showRegisterDialog:{bool:!1}}},components:{LoginDialog:_,LogoutDialog:a("VU/8")(x,C,!1,null,null,null).exports,RegisterDialog:w}},E={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",{attrs:{id:"inspire"}},[a("v-toolbar",{attrs:{"clipped-left":t.$vuetify.breakpoint.smAndUp,"clipped-right":t.$vuetify.breakpoint.smAndUp,color:"blue darken-3",dark:"",app:"",fixed:""}},[a("v-toolbar-title",{staticClass:"ml-0 pl-3",staticStyle:{width:"300px"}},[a("v-toolbar-side-icon",{staticClass:"hidden-sm-and-up",on:{click:function(e){e.stopPropagation(),t.globalObject.showDrawer=!t.globalObject.showDrawer}}}),t._v(" "),a("a",{staticClass:"title",attrs:{href:"/"}},[t._v(t._s(t.title))])],1),t._v(" "),a("v-text-field",{staticClass:"hidden-sm-and-down",attrs:{flat:"","solo-inverted":"","prepend-icon":"search",label:"Search"}}),t._v(" "),a("v-spacer"),t._v(" "),a("v-btn",{attrs:{icon:""}},[a("v-icon",[t._v("notifications")])],1),t._v(" "),t.isLoggedIn?t._e():a("v-btn",{staticClass:"hidden-xs-only",attrs:{outline:""},on:{click:t.onRegisterClicked}},[a("span",[t._v("註冊")])]),t._v(" "),a("v-btn",{staticClass:"hidden-xs-only",attrs:{outline:""},on:{click:t.onLoginLogoutClicked}},[a("span",[t._v(t._s(t.isLoggedIn?"登出":"登入"))])])],1),t._v(" "),a("router-view"),t._v(" "),a("register-dialog",{attrs:{show:t.showRegisterDialog,toggle:t.showRegisterDialog.bool}}),t._v(" "),a("login-dialog",{attrs:{show:t.showLoginDialog,toggle:t.showLoginDialog.bool},on:{"logged-in":t.onLoggedIn}}),t._v(" "),a("logout-dialog",{attrs:{show:t.showLogoutDialog,toggle:t.showLoginDialog.bool,userid:t.globalObject.userData.userId},on:{"logged-out":t.onLoggedOut}})],1)},staticRenderFns:[]};var P=a("VU/8")(y,E,!1,function(t){a("bbS4"),a("EGgQ"),a("BgfR")},"data-v-eb4053ca",null).exports,D=a("/ocq"),I=a("Gu7T"),L=a.n(I),U={heading:"文章列表",showProgress:!0},O={created:function(){this.updateList()},methods:{updateList:function(){var t=this;t.showProgress=!0,g.getCategoryList().then(function(e){var a;t.globalObject.categories.length=0,(a=t.globalObject.categories).push.apply(a,L()(e)),t.showProgress=!1})}},data:function(){return U},props:{category:String}},N={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-list",{attrs:{subheader:""}},[a("v-layout",{key:t.heading,staticStyle:{position:"relative"},attrs:{row:"",wrap:"","align-center":""}},[a("v-flex",{attrs:{xs12:""}},[a("v-subheader",[t._v("\n        "+t._s(t.heading)+"\n      ")]),t._v(" "),a("v-list-tile",{attrs:{"active-class":"default-class active-class",to:{name:"category",params:{category:"all"}},ripple:""}},[a("v-list-tile-content",[a("v-list-tile-title",[t._v("\n            全部文章\n          ")])],1)],1),t._v(" "),t._l(t.globalObject.categories,function(e){return[a("v-list-tile",{key:e.text,attrs:{"active-class":"default-class active-class",to:{name:"category",params:{category:e.url}},ripple:""}},[a("v-list-tile-content",[a("v-list-tile-title",[t._v("\n              "+t._s(e.text)+"\n            ")])],1)],1)]})],2)],1),t._v(" "),a("v-progress-circular",{directives:[{name:"show",rawName:"v-show",value:t.showProgress,expression:"showProgress"}],staticStyle:{position:"absolute",top:"50%",right:"50%"},attrs:{indeterminate:"",color:"green"}})],1)},staticRenderFns:[]};var R={heading:"功能",items:[{icon:"contacts",text:"好友"},{icon:"settings",text:"設定"},{icon:"chat_bubble",text:"回饋"},{icon:"help",text:"幫助"}]},j={data:function(){return R},methods:{toChatPage:function(){this.$router.push("/messaging")}}},M={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-list",[a("v-layout",{key:t.heading,attrs:{row:"","align-center":""}},[a("v-flex",{attrs:{xs12:""}},[a("v-subheader",[t._v("\n        "+t._s(t.heading)+"\n      ")])],1)],1),t._v(" "),a("v-list-tile",{on:{click:t.toChatPage}},[a("v-list-tile-action",[a("v-icon",[t._v("contacts")])],1),t._v(" "),a("v-list-tile-content",[a("v-list-tile-title",[t._v("\n        好友\n      ")])],1)],1),t._v(" "),a("v-list-tile",{on:{click:function(t){}}},[a("v-list-tile-action",[a("v-icon",[t._v("settings")])],1),t._v(" "),a("v-list-tile-content",[a("v-list-tile-title",[t._v("\n        設定\n      ")])],1)],1),t._v(" "),a("v-list-tile",{on:{click:function(t){}}},[a("v-list-tile-action",[a("v-icon",[t._v("chat_bubble")])],1),t._v(" "),a("v-list-tile-content",[a("v-list-tile-title",[t._v("\n        回饋\n      ")])],1)],1),t._v(" "),a("v-list-tile",{on:{click:function(t){}}},[a("v-list-tile-action",[a("v-icon",[t._v("help")])],1),t._v(" "),a("v-list-tile-content",[a("v-list-tile-title",[t._v("\n        幫助\n      ")])],1)],1)],1)},staticRenderFns:[]},S={methods:{},data:function(){return{}},components:{CategoryList:a("VU/8")(O,N,!1,function(t){a("sFho")},null,null).exports,FunctionList:a("VU/8")(j,M,!1,null,null,null).exports}},F={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-content",[a("v-navigation-drawer",{attrs:{clipped:"",fixed:"","mobile-break-point":"600",app:""},model:{value:t.globalObject.showDrawer,callback:function(e){t.$set(t.globalObject,"showDrawer",e)},expression:"globalObject.showDrawer"}},[a("category-list"),t._v(" "),a("function-list",{staticClass:"hidden-lg-and-up"})],1),t._v(" "),a("v-navigation-drawer",{attrs:{clipped:"",fixed:"",right:"",app:""}},[a("function-list")],1),t._v(" "),a("router-view")],1)},staticRenderFns:[]},$=a("VU/8")(S,F,!1,null,null,null).exports,A={beforeRouteEnter:function(t,e,a){a(function(t){t.updatePostList()})},watch:{category:function(){this.updatePostList()}},methods:{updatePostList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"createdTime",e=this,a=e.category;e.showProgress=!0,e.postList.length=0,g.getPostList(e.category,t).then(function(t){var s;a===e.category&&(s=e.postList).push.apply(s,L()(t));e.showProgress=!1})},increasePostExplore:function(t){g.increasePostExplore(t)}},data:function(){return{tabs:{"tab-1":{text:"熱門文章",orderBy:"like"},"tab-2":{text:"最新文章",orderBy:"createdTime"}},modelTab:"tab-1",postList:[],menuItems:[{text:"發佈時間",orderBy:"createdTime"},{text:"閱覽次數",orderBy:"explore"},{text:"按讚次數",orderBy:"like"},{text:"回覆次數",orderBy:"reply"}],showProgress:!1}},props:["category"]},B={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{staticStyle:{height:"100%",position:"relative"},attrs:{fluid:""}},[a("v-flex",{staticStyle:{position:"absolute",top:"50%",left:"50%"},attrs:{xs12:""}},[a("v-progress-circular",{directives:[{name:"show",rawName:"v-show",value:t.showProgress,expression:"showProgress"}],attrs:{indeterminate:"",color:"green"}})],1),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"","d-flex":"","align-baseline":""}},[a("v-card",{attrs:{dark:"",color:"blue darken-1"}},[a("v-card-title",{attrs:{"primary-title":""}},[a("span",{staticClass:"headline d-inline-box"},[t._v(t._s(t.getCategoryName(t.category)||"全部文章"))]),t._v(" "),a("div",[a("v-menu",{attrs:{"offset-y":"","open-on-hover":""}},[a("v-btn",{attrs:{slot:"activator",flat:""},slot:"activator"},[t._v("排序依據...")]),t._v(" "),a("v-list",t._l(t.menuItems,function(e,s){return a("v-list-tile",{key:s,on:{click:function(){return t.updatePostList(e.orderBy)}}},[a("v-list-tile-title",[t._v(t._s(e.text))])],1)}))],1)],1),t._v(" "),a("v-spacer"),t._v(" "),"all"!==t.category?a("v-btn",{attrs:{dark:"",fab:"",color:"blue darken-3",to:{name:"newpost",params:{category:t.category}}}},[a("v-icon",[t._v("create")])],1):t._e()],1)],1)],1)],1),t._v(" "),a("v-layout",{staticStyle:{position:"relative"},attrs:{row:"",wrap:"","fill-height":""}},[a("v-flex",{attrs:{xs12:""}},[a("v-list",{attrs:{"three-line":""}},[t._l(t.postList,function(e,s){return[0!==s?a("v-divider",{key:s}):t._e(),t._v(" "),a("v-list-tile",{key:e.postId,attrs:{avatar:"",to:{name:"post",params:{postId:e.postId}}},on:{click:function(){return t.increasePostExplore(e.postId)}}},[a("v-flex",{attrs:{xs10:""}},[a("v-layout",{attrs:{"d-flex":"",row:""}},[a("v-flex",{attrs:{"offset-xs1":"",xs4:""}},[a("v-list-tile-title",{},[t._v(t._s(e.title))])],1),t._v(" "),a("v-flex",{attrs:{"offset-xs3":"",xs3:""}},[a("v-list-tile-sub-title",{staticClass:"text-lg-right"},[t._v(t._s(e.authorName))])],1)],1)],1),t._v(" "),a("v-flex",{attrs:{xs2:""}},[a("v-layout",{attrs:{"d-flex":"",column:"","align-content-end":""}},[a("v-layout",{attrs:{"d-flex":"",column:"","align-start":""}},[a("v-flex",[a("v-list-tile-sub-title",[a("v-icon",{attrs:{size:"20",color:"grey"}},[t._v("thumb_up")]),t._v(" : "+t._s(e.like))],1)],1),t._v(" "),a("v-flex",[a("v-list-tile-sub-title",[a("v-icon",{attrs:{size:"20",color:"grey"}},[t._v("remove_red_eye")]),t._v(" : "+t._s(e.explore))],1)],1),t._v(" "),a("v-flex",[a("v-list-tile-sub-title",[a("v-icon",{attrs:{size:"20",color:"grey"}},[t._v("textsms")]),t._v(" : "+t._s(e.reply))],1)],1)],1)],1)],1)],1)]})],2)],1)],1)],1)},staticRenderFns:[]},z=a("VU/8")(A,B,!1,null,null,null).exports,T={props:{show:Object,toggle:Boolean},watch:{toggle:function(t){this.reset()}},methods:{searchUserByMail:function(){var t=this;g.searchUserByEmail(t.inputEmail).then(function(e){if(console.log(e),!e)return!1;t.userName=e.userName,t.avatarUrl=e.avatarUrl,t.avatarUrl?t.noAvatar=!1:(t.noAvatar=!0,t.avatarChar=t.userName[0])}).catch(function(t){console.log(t)})},addFriend:function(){var t=this.globalObject.userData.userId;g.addFriend(t,this.inputEmail).catch(function(t){console.log(t)})}},data:function(){return{inputEmail:void 0,showProgress:!1,userName:void 0,avatarUrl:"",avatarChar:void 0,noAvatar:void 0}}},V={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-dialog",{attrs:{"max-width":"400"},model:{value:t.show.bool,callback:function(e){t.$set(t.show,"bool",e)},expression:"show.bool"}},[a("v-card",[a("v-card-title",{staticClass:"headline blue darken-2"},[a("v-container",{staticClass:"pa-0",attrs:{"d-flex-column":"","justify-center":"","text-xs-center":""}},[a("v-text-field",{staticClass:"hidden-sm-and-down",attrs:{flat:"",dark:"","solo-inverted":"","prepend-icon":"search",label:"搜尋 (E-mail)"},on:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.searchUserByMail()}},model:{value:t.inputEmail,callback:function(e){t.inputEmail=e},expression:"inputEmail"}})],1)],1),t._v(" "),a("v-container",{attrs:{"d-flex-column":"","justify-center":"","text-xs-center":""}},[a("v-avatar",{directives:[{name:"show",rawName:"v-show",value:!t.noAvatar,expression:"!noAvatar"}],attrs:{size:"200"}},[a("img",{directives:[{name:"show",rawName:"v-show",value:t.avatarUrl,expression:"avatarUrl"}],attrs:{icon:"",src:t.avatarUrl}})]),t._v(" "),a("v-avatar",{directives:[{name:"show",rawName:"v-show",value:t.noAvatar,expression:"noAvatar"}],attrs:{color:"teal",size:"200"}},[a("span",{staticClass:"white--text avatar-text"},[t._v(t._s(t.avatarChar))])]),t._v(" "),a("h1",{staticClass:"friend-name"},[t._v(t._s(t.userName))]),t._v(" "),a("v-container",{attrs:{"d-flex":"","justify-center":""}},[a("v-btn",{attrs:{dark:"",color:"light-blue accent-3"},on:{click:t.addFriend}},[t._v("加為好友")])],1)],1)],1),t._v(" "),a("v-progress-circular",{directives:[{name:"show",rawName:"v-show",value:t.showProgress,expression:"showProgress"}],attrs:{indeterminate:"",color:"green"}})],1)},staticRenderFns:[]};var G=a("VU/8")(T,V,!1,function(t){a("g0QH")},"data-v-7a1f265b",null).exports,H={created:function(){var t=i()(n.a.mark(function t(){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.getFriendList();case 1:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),watch:{"globalObject.userData.userId":function(){this.globalObject.userData.userId?this.getFriendList():this.friendList={}}},methods:{getFriendList:function(){var t=this;g.getFriendList(this.globalObject.userData.userId).then(function(e){var a=t;a.friendList=e,e.avatarUrl?a.noAvatar=!1:a.noAvatar=!0}).catch(function(t){console.log("取得好友列表錯誤")})},route:function(t){this.$router.push({name:"chat",params:{friendId:t.userId,avatarUrl:t.avatarUrl}})},onAddFriendClicked:function(){this.showAddFriendDialog.bool=!0}},data:function(){return{friendList:[],avatarUrl:"",avatarChar:"",noAvatar:!1,showAddFriendDialog:{bool:!1}}},components:{AddFriendDialog:G}},Q={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-list",[t._l(t.friendList,function(e){return[a("v-list-tile",{key:e.text,attrs:{avatar:""},on:{click:function(){return t.route(e)}}},[a("v-list-tile-avatar",{directives:[{name:"show",rawName:"v-show",value:e.avatarUrl,expression:"friend.avatarUrl"}]},[a("img",{attrs:{src:e.avatarUrl,alt:"avatar"}})]),t._v(" "),a("v-list-tile-avatar",{directives:[{name:"show",rawName:"v-show",value:!e.avatarUrl,expression:"!friend.avatarUrl"}],attrs:{color:"teal"}},[a("span",{staticClass:"white--text avatar-text"},[t._v(t._s((e.userName||"")[0]))])]),t._v(" "),a("v-list-tile-content",[a("v-list-tile-title",[t._v("\n          "+t._s(e.userName)+"\n        ")]),t._v(" "),a("v-list-tile-sub-title",[t._v("\n          "+t._s(e.lastMessage)+"\n        ")])],1)],1)]}),t._v(" "),a("v-container",{attrs:{"d-flex":""}},[a("v-btn",{attrs:{color:"success"},on:{click:t.onAddFriendClicked}},[t._v("\n      新增好友\n    ")])],1),t._v(" "),a("add-friend-dialog",{attrs:{show:t.showAddFriendDialog,toggle:t.showAddFriendDialog.bool}})],2)},staticRenderFns:[]};var Z={components:{ChatList:a("VU/8")(H,Q,!1,function(t){a("TdDx")},null,null).exports}},q={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-content",[a("v-navigation-drawer",{attrs:{clipped:"",fixed:"","hide-overlay":"","mobile-break-point":"600",app:""},model:{value:t.globalObject.showDrawer,callback:function(e){t.$set(t.globalObject,"showDrawer",e)},expression:"globalObject.showDrawer"}},[a("chat-list")],1),t._v(" "),a("router-view")],1)},staticRenderFns:[]},X=a("VU/8")(Z,q,!1,null,null,null).exports,J=a("EFqf"),K=a.n(J),W={computed:{isMarkdown:{get:function(){return this.postData.isMarkdown?1:0},set:function(t){this.postData.isMarkdown=1===t}},compiledMarkdown:function(){return K()(this.currentContentPart.text.replace(/( )*\n+/g,"    \n"),{sanitize:!0})}},methods:{onInsertPictureClick:function(){},onInsertLinkClick:function(){},onInsertCodeClick:function(){},sendNewPost:function(){var t=this;t.showProgress=!0,t.postData.authorId=t.globalObject.userData.userId,t.postData.authorName=t.globalObject.userData.userName,t.postData.category=t.category,t.postData.content.push(t.currentContentPart),t.currentContentPart={type:"plain",text:""},g.addPost(t.postData).then(function(){t.showProgress=!1,t.$router.go(-1)})}},data:function(){return{postData:{title:"",authorId:"",authorName:"",category:"",isMarkdown:!1,content:[]},currentContentPart:{type:"plain",text:""},fab:void 0,showMdPreview:!1,showProgress:!1}},props:{category:String}},Y={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{staticStyle:{height:"100%",position:"relative"},attrs:{fluid:""}},[a("v-card",[a("v-progress-circular",{directives:[{name:"show",rawName:"v-show",value:t.showProgress,expression:"showProgress"}],staticStyle:{position:"absolute",top:"50%",left:"50%"},attrs:{indeterminate:"",color:"green"}}),t._v(" "),a("v-speed-dial",{staticStyle:{bottom:"5%",right:"5%"},attrs:{absolute:"",direction:"top"},model:{value:t.fab,callback:function(e){t.fab=e},expression:"fab"}},[a("v-btn",{attrs:{slot:"activator",color:"teal darken-1",dark:"",fab:""},slot:"activator",model:{value:t.fab,callback:function(e){t.fab=e},expression:"fab"}},[a("v-icon",[t._v("add")]),t._v(" "),a("v-icon",[t._v("close")])],1),t._v(" "),a("v-btn",{attrs:{fab:"",dark:"",small:"",color:"blue darken-3"},on:{click:t.onInsertPictureClick}},[a("v-icon",[t._v("insert_photo")])],1),t._v(" "),a("v-btn",{attrs:{fab:"",dark:"",small:"",color:"blue darken-2"},on:{click:t.onInsertLinkClick}},[a("v-icon",[t._v("link")])],1),t._v(" "),a("v-btn",{attrs:{fab:"",dark:"",small:"",color:"blue darken-1"},on:{click:t.onInsertCodeClick}},[a("v-icon",[t._v("code")])],1)],1),t._v(" "),a("v-dialog",{attrs:{"max-width":"960"},model:{value:t.showMdPreview,callback:function(e){t.showMdPreview=e},expression:"showMdPreview"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Markdown 預覽")])]),t._v(" "),a("v-divider"),t._v(" "),a("v-card-text",[t.postData.isMarkdown?a("v-flex",{staticClass:"d-inline-block pa-2",attrs:{xs12:""},domProps:{innerHTML:t._s(t.compiledMarkdown)}}):t._e()],1)],1)],1),t._v(" "),a("v-layout",{staticClass:"pa-3",attrs:{"d-flex":"","align-center":"",column:"",wrap:""}},[a("v-flex",[a("v-btn-toggle",{attrs:{mandatory:""},model:{value:t.isMarkdown,callback:function(e){t.isMarkdown=e},expression:"isMarkdown"}},[a("v-btn",{attrs:{flat:"",color:"blue darken-2"}},[a("span",[t._v("一般")])]),t._v(" "),a("v-btn",{attrs:{flat:"",color:"blue darken-2"}},[a("span",[t._v("Markdown")])])],1),t._v(" "),t.postData.isMarkdown?a("v-btn",{on:{click:function(e){t.showMdPreview=!0}}},[t._v("預覽")]):t._e()],1)],1),t._v(" "),a("v-layout",{staticClass:"pa-3",attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-container",{attrs:{"pb-0":""}},[a("v-text-field",{attrs:{placeholder:"標題",autofocus:""},model:{value:t.postData.title,callback:function(e){t.$set(t.postData,"title",e)},expression:"postData.title"}})],1)],1),t._v(" "),t.postData.isMarkdown?t._e():a("v-flex",{attrs:{"xs-12":""}},[a("v-container",{attrs:{"pt-0":""}},[a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{name:"input-1",label:"內容",textarea:"","multi-line":"",rows:"13"},on:{click:function(e){t.currentContentPart.type="plain"}},model:{value:t.currentContentPart.text,callback:function(e){t.$set(t.currentContentPart,"text",e)},expression:"currentContentPart.text"}})],1)],1)],1)],1),t._v(" "),t.postData.isMarkdown?a("v-flex",{attrs:{xs12:""}},[a("v-container",{attrs:{"pt-0":""}},[a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{name:"input-1",label:"Markdown",textarea:"","multi-line":"",rows:"13"},on:{click:function(e){t.currentContentPart.type="plain"}},model:{value:t.currentContentPart.text,callback:function(e){t.$set(t.currentContentPart,"text",e)},expression:"currentContentPart.text"}})],1)],1)],1)],1):t._e()],1),t._v(" "),a("v-layout",{staticClass:"pa-3",attrs:{"d-flex":"","align-center":"",column:"",wrap:""}},[a("v-flex",[a("v-btn",{attrs:{dark:"",color:"blue"},on:{click:function(){return t.sendNewPost()}}},[t._v("送出")])],1)],1)],1)],1)},staticRenderFns:[]},tt=a("VU/8")(W,Y,!1,null,null,null).exports,et={beforeRouteEnter:function(t,e,a){a(function(t){t.loadPostData()})},computed:{compiledMarkdown:function(t){return K()(this.postData.content[t].text,{sanitize:!0})}},methods:{loadPostData:function(){var t=this;g.getPostData(t.postId).then(function(e){t.postData=e})}},data:function(){return{postData:{}}},props:{postId:String}},at={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{fluid:""}},[a("v-card",[a("v-card-title",{staticClass:"headline blue white--text"},[t._v("文章 : "+t._s(t.postData.title))]),t._v(" "),a("v-card-text",[a("v-layout",{attrs:{row:"",wrap:"","fill-height":""}},[a("v-flex",{attrs:{xs12:"",wrap:""}},[t._l(t.postData.content,function(e){return[a("p",{key:e.text},[t._v(t._s(e.text))])]})],2)],1)],1)],1),t._v(" "),a("v-card",{staticClass:"my-1"},[a("v-layout",[a("v-flex",{attrs:{xs12:""}},[a("v-container",[t._v("\n            留言\n          ")])],1)],1)],1)],1)},staticRenderFns:[]},st=a("VU/8")(et,at,!1,null,null,null).exports,rt={watch:{"globalObject.userData.userId":function(){this.globalObject.userData.userId||(this.messages=[])}},created:function(){this.setChat()},updated:function(){var t=document.querySelector(".chat-body");t.scrollTop=t.scrollHeight},methods:{setChat:function(){var t=this,e=t.globalObject.userData.userId;g.getChat(e,t.friendId).onSnapshot(function(e){t.chatId=e.id,t.messages=e.data().messages||[]})},sendMessage:function(t){console.log(t);var e=this,a=e.message.trim(),s=e.globalObject.userData.userId,r=e.friendId;if(a){if(t.shiftKey)return!1;if(a.length<=1&&""===a.trim())return!1;e.messages.push({userName:e.globalObject.userData.userName,userId:e.globalObject.userData.userId,type:"text",message:a.trim(),timeStamp:g.getTimeStamp()}),g.sendMessage(s,r,e.messages),e.message=""}}},data:function(){return{messages:[],message:""}},props:{friendId:String,avatarUrl:String}},nt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{"d-block":"",fluid:"","fill-height":"",white:"","py-0":""}},[a("v-layout",{staticClass:"chat-body pb-0"},[t._l(t.messages,function(e){return[e.userId!=t.globalObject.userData.userId?[a("div",{staticClass:"message"},[a("img",{directives:[{name:"show",rawName:"v-show",value:t.avatarUrl,expression:"avatarUrl"}],staticClass:"message__user",attrs:{src:t.avatarUrl,draggable:"false"}}),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.avatarUrl,expression:"!avatarUrl"}],staticClass:"message__user"},[a("v-avatar",{attrs:{color:"teal",size:"40"}},[a("span",{staticClass:"white--text headline"},[t._v(t._s((e.userName||"")[0]))])])],1),t._v(" "),a("div",{staticClass:"message__content"},[a("div",{staticClass:"message__name"},[t._v(t._s(e.userName))]),t._v(" "),"text"==e.type?a("div",{staticClass:"message__message"},[a("div",{staticClass:"message__text"},[t._v(t._s(e.message))])]):t._e(),t._v(" "),"image"==e.type?a("div",{staticClass:"message__image"},[a("img",{attrs:{src:e.message}})]):t._e()]),t._v(" "),a("div",{staticClass:"message__time"},[t._v(t._s(e.timeStamp))])])]:t._e(),t._v(" "),e.userId==t.globalObject.userData.userId?[a("div",{staticClass:"message message--self"},[a("div",{staticClass:"message__time"},[t._v(t._s(e.timeStamp))]),t._v(" "),a("div",{staticClass:"message__content"},["text"==e.type?a("div",{staticClass:"message__message"},[a("div",{staticClass:"message__text"},[t._v(t._s(e.message))])]):t._e(),t._v(" "),"image"==e.type?a("div",{staticClass:"message__image"},[a("img",{attrs:{src:e.message}})]):t._e()])])]:t._e()]})],2),t._v(" "),a("v-container",{attrs:{fluid:"","pa-0":""}},[a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{staticClass:"chat-input",attrs:{id:"js-message",label:"輸入訊息",rows:"4",textarea:"","hide-details":""},on:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.sendMessage(e)}},model:{value:t.message,callback:function(e){t.message=e},expression:"message"}})],1)],1)],1)],1)},staticRenderFns:[]};var ot=a("VU/8")(rt,nt,!1,function(t){a("uveh")},null,null).exports;s.a.use(D.a);var it=new D.a({mode:"history",routes:[{path:"/",redirect:"/forum/all"},{path:"/forum",name:"forum",component:$,children:[{path:":category",name:"category",component:z,props:!0},{path:":category/new",name:"newpost",component:tt,props:!0},{path:":category/p/:postId",name:"post",component:st,props:!0}],props:!0},{path:"/messaging",name:"messaging",component:X,children:[{path:":friendId",name:"chat",component:ot,props:!0}],props:!0}]}),lt=a("3EgV"),ct=a.n(lt),ut=a("5CJf"),dt=a.n(ut);a("7zck");s.a.use(dt.a),s.a.use(ct.a),s.a.config.productionTip=!1;var ht={userData:{userId:"",userName:""},categories:[],showDrawer:null},vt={methods:{saveUserData:function(t){this.globalObject.userData=t,localStorage.setItem("userId",t.userId),localStorage.setItem("userName",t.userName)},clearUserData:function(){localStorage.removeItem("userId"),localStorage.removeItem("userName"),this.globalObject.userData={}},initUserData:function(){ht.userData.userId=localStorage.getItem("userId"),ht.userData.userName=localStorage.getItem("userName")},getCategoryName:function(t){var e=void 0,a=!1;return this.globalObject.categories.forEach(function(s){s.url!==t||a||(e=s.text,a=!0)}),e}},data:function(){return{globalObject:ht}}};s.a.mixin(vt),new s.a({el:"#app",router:it,components:{App:P},beforeCreate:function(){vt.methods.initUserData()},template:"<App/>"})},TdDx:function(t,e){},XdeR:function(t,e){},bbS4:function(t,e){},g0QH:function(t,e){},sFho:function(t,e){},uveh:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.79f0958231f2e11948c3.js.map